---
title: "Stepwise_Regress"
output: html_document
date: "2023-04-11"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(MASS)
library(ggplot2)
library(caret)
set.seed(123)
```
```{r}
train_cf <- read.csv('C:/Users/tulip/BME580/project/Train_CaseFatality.csv', header = TRUE)
test_cf <- read.csv('C:/Users/tulip/BME580/project/Test_CaseFatality.csv', header = TRUE)
train_ir <- read.csv('C:/Users/tulip/BME580/project/Train_Incident.csv', header = TRUE)
train_ir<-train_ir[,-14]
test_ir <- read.csv('C:/Users/tulip/BME580/project/Test_Incident.csv', header = TRUE)
test_ir<-test_ir[,-14]

head(train_ir, 10)
test_ir
train_ir$State <- as.factor(train_ir$State)
train_ir$Month <- as.factor(train_ir$Month)
test_ir$State <- as.factor(test_ir$State)
test_ir$Month <- as.factor(test_ir$Month)
```

```{r}
model <- lm(Incident_Rate ~ ., data = train_ir)
model
summary(model)

plot(model$residuals)
median(model$residuals)
hist(model$residuals)
model$residuals
mean((model$residuals)^2)
step_model <- step(model, direction = "both", k = log(13))
summary(step_model)
test_pred <- predict(step_model, newdata = test_ir)
test_pred
test_error <- mean((test_ir$Incident_Rate - test_pred)^2)
test_error
```
