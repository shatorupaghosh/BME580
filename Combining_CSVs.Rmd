---
title: "Combining_CSVs"
author: "Sophia Leeman"
date: "2023-04-02"
output: html_document
---

```{r}
df1 <- read.csv('Final_COV.csv', header = TRUE)
df2 <- read.csv('Weather/airpress_cleaned.csv', header = TRUE)
df3 <- read.csv('Weather/humidity_cleaned.csv', header = TRUE)
df4 <- read.csv('mental_cleaned.csv',header = TRUE)

```

```{r}
df1
df2
df3
df4
```

```{r}
library(zoo)

# Convert year_month column in df1 to standardized "year-month" format
df1$year_month <- as.yearmon(df1$year_month, "%Y-%m")
df1$Year <- as.integer(df1$year_month)
df1$Month <- substring(df1$year_month, 1, 3)
df1$State <- df1$Province_State

df2$Month <- substring(df2$Month, 1, 3)
df2$State <- df2$State.Name
df3$Month <- substring(df3$Month, 1, 3)
df3$State <- df3$State.Name
df4$Month <- substring(df4$Month, 1, 3)


head(df1)
head(df2)
head(df3)
df4
```


```{r}
merge1 <- merge(df1, df2, by=c('State', 'Year', 'Month'), all=TRUE)
merge2 <- merge(merge1, df3, by=c('State', 'Year', 'Month'), all=TRUE)
merge3 <- merge(merge2, df4, by =c('State', 'Year', 'Month'), all=TRUE)
merge3


```


```{r}

merge3 <- merge3[, !(names(merge3) %in% c('Province_State', 'year_month', 'State.Name.x', 'State.Name.y'))]

merge3
summary(merge3)
merge3 <- na.omit(merge3)
merge3

write.csv(merge3, "/Users/sophialeeman/Documents/BME 580/BME-580/All_Data.csv", row.names=FALSE)
```